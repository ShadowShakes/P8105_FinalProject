<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Victim Analysis</title>

<script src="site_libs/header-attrs-2.16/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<script src="site_libs/plotly-binding-4.10.0/plotly.js"></script>
<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>
<link href="site_libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="site_libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="site_libs/plotly-htmlwidgets-css-2.5.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="site_libs/plotly-main-2.5.1/plotly-latest.min.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Home</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="Data_Preprocessing.html">Data &amp; Processing</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Data-driven Analysis
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Analysis_Suspect.html">Suspect Analysis</a>
    </li>
    <li>
      <a href="Analysis_Victim.html">Victim Analysis</a>
    </li>
    <li>
      <a href="Analysis_Region.html">Region Analysis</a>
    </li>
    <li>
      <a href="Analysis_Time.html">Time Range Analysis</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Shiny App
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Shiny_Notification.html">Shiny App Notification</a>
    </li>
    <li>
      <a href="https://shadowshakes.shinyapps.io/app_before_covid/">Shiny Map Before Covid</a>
    </li>
    <li>
      <a href="https://shadowshakes.shinyapps.io/app_after_covid/">Shiny Map After Covid</a>
    </li>
    <li>
      <a href="https://shadowshakes.shinyapps.io/app_detect_safety/">Shiny Safety Assessment</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    CUMC Safety Analysis
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Analysis_CUMC.html">Visual Analysis</a>
    </li>
    <li>
      <a href="https://shadowshakes.shinyapps.io/app_cumc/">CUMC Safety Map</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="Project_Report.html">Conclusion &amp; Report</a>
</li>
<li>
  <a href="https://www.youtube.com/">Screencast</a>
</li>
<li>
  <a href="about.html">About</a>
</li>
<li>
  <a href="mailto:&lt;sc5154@cumc.columiba.edu&gt;">
    <span class="fa fa-envelope fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/ShadowShakes/P8105_Final_Project">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Victim Analysis</h1>

</div>


<center>
<img src="Images/victim_1.jpeg" style="width:100%">
</center>
 
<p>Our dataset does not contain data for October, November and December
of the year 2022. We are interested in the following main felonies:
Burglary, Felony Assault, Grand Larceny, Grand Larceny of Motor Vehicle,
Murder and Non-negligent Manslaughter, Rape, and Robbery.</p>
<div id="daily-crimes-on-different-dangerous-level"
class="section level2">
<h2>Daily crimes on different dangerous level</h2>
<pre class="r"><code>dangrous_data=complaint %&gt;% 
  select(-day_of_week) %&gt;% 
  dplyr::filter(!is.na(vic_race)) %&gt;% 
  dplyr::filter(!is.na(level)) %&gt;% 
  dplyr::filter(!is.na(vic_age_group)) %&gt;% 
  dplyr::filter(!is.na(vic_sex))
  

dangrous_data = dangrous_data%&gt;% 
  mutate(
   level_lm = case_when(
     level == &#39;VIOLATION&#39; ~ 0,
     level == &quot;MISDEMEANOR&quot; ~ 1,
     level == &quot;FELONY&quot; ~ 2
   )
  )</code></pre>
<p>From the data, we can easily find that violation represents the
lowest level, followed by misdemeanors and felonies. Therefore, they are
assigned 0, 1, and 2 to represent the degree of danger of the event,
that is, the risk factor faced by the victim.</p>
</div>
<div id="relationship-between-victim-characteristics-and-crime-level"
class="section level2">
<h2>Relationship between victim characteristics and crime level</h2>
<div id="victim-gender-analysis" class="section level3">
<h3>Victim Gender Analysis</h3>
</div>
<div id="number-of-incidents-on-different-gender"
class="section level3">
<h3>Number of incidents on different gender</h3>
<pre class="r"><code>plot_his_sex = dangrous_data %&gt;% 
  group_by(level,vic_sex) %&gt;% 
  dplyr::summarize(
    n_obs= n(),
    type = level_lm
  ) %&gt;% 
  unique() %&gt;% 
  ggplot(
    aes(x = level,y = n_obs,fill = vic_sex)
  ) +
  geom_bar(stat=&quot;identity&quot;) +
  labs(
    title = &quot;relationship between dangerous and victim sex&quot;,
    x = &quot;dangerous level&quot;,
    y = &quot;number of cases&quot;
  )
plot_his_sex</code></pre>
<p><img src="Analysis_Victim_files/figure-html/unnamed-chunk-2-1.png" width="80%" /></p>
<p>Through the stacked bar chart, we can see that when the danger level
is violation (0), the number of incidents where the victim is a woman is
much higher than that of a man. At intermediate and higher levels, no
significant differences can be observed by observation,</p>
<pre class="r"><code>plot_pie_sex0 = dangrous_data %&gt;%
  group_by(level,vic_sex) %&gt;% 
  dplyr::summarize(
    n_obs = n(),
    type = level_lm
  ) %&gt;% 
  unique() %&gt;%
  filter(type == 0)

plot_pie_sex0=plot_ly(plot_pie_sex0,labels =~ vic_sex,values= ~n_obs) %&gt;% 
  add_pie %&gt;% 
  layout(title = &quot;VIOLATION for vic_sex&quot;)

plot_pie_sex1 = dangrous_data %&gt;%
  group_by(level,vic_sex) %&gt;% 
  dplyr::summarize(
    n_obs = n(),
    type = level_lm
  ) %&gt;% 
  unique() %&gt;%
  filter(type == 1)

plot_pie_sex1 = plot_ly(plot_pie_sex1,labels = ~ vic_sex,values = ~n_obs) %&gt;% 
  add_pie %&gt;% 
  layout(title = &quot;MISDEMEANOR for vic_sex&quot;)

plot_pie_sex2 = dangrous_data %&gt;%
  group_by(level,vic_sex) %&gt;% 
  dplyr::summarize(
    n_obs = n(),
    type = level_lm
  ) %&gt;% 
  unique() %&gt;%
  filter(type == 2)

plot_pie_sex2 = plot_ly(plot_pie_sex2,labels = ~ vic_sex,values = ~n_obs) %&gt;% 
  add_pie %&gt;% 
  layout(title = &quot;FELONY for vic_sex&quot;)

par(mfrow = c(1,3))
plot_pie_sex0</code></pre>
<div id="htmlwidget-b6e4d9435f6e9b82b016" style="width:80%;height:864px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-b6e4d9435f6e9b82b016">{"x":{"visdat":{"4198447500af":["function () ","plotlyVisDat"]},"cur_data":"4198447500af","attrs":{"4198447500af":{"labels":{},"values":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"pie","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"VIOLATION for vic_sex","hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"labels":["F","M"],"values":[284922,157163],"type":"pie","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(255,255,255,1)"}},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>plot_pie_sex1</code></pre>
<div id="htmlwidget-b123d5195d1c5a5e8f1e" style="width:80%;height:864px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-b123d5195d1c5a5e8f1e">{"x":{"visdat":{"41985d800445":["function () ","plotlyVisDat"]},"cur_data":"41985d800445","attrs":{"41985d800445":{"labels":{},"values":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"pie","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"MISDEMEANOR for vic_sex","hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"labels":["F","M"],"values":[536728,488121],"type":"pie","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(255,255,255,1)"}},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>plot_pie_sex2</code></pre>
<div id="htmlwidget-c7d6c963de8a08b3d213" style="width:80%;height:864px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-c7d6c963de8a08b3d213">{"x":{"visdat":{"41987f987df7":["function () ","plotlyVisDat"]},"cur_data":"41987f987df7","attrs":{"41987f987df7":{"labels":{},"values":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"pie","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"FELONY for vic_sex","hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"labels":["F","M"],"values":[325917,357391],"type":"pie","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(255,255,255,1)"}},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="prediction-of-crime-level-based-on-logistic-regression"
class="section level3">
<h3>Prediction of crime level based on logistic regression</h3>
<p>In order to simplify the model and facilitate effective verification,
we classify felony and misdemeanors with no obvious difference into one
category - high risk, regard violation as low risk, and assign ordinal
variables 1, 0 respectively.</p>
<pre class="r"><code>#manipulate a logistic regression about level~vic

dangrous_data = dangrous_data %&gt;% 
  mutate(
   level_lm = case_when(
     level == &#39;VIOLATION&#39; ~ 0,
     level == &quot;MISDEMEANOR&quot; ~ 0,
     level == &quot;FELONY&quot; ~ 1
   )
  ) %&gt;% 
  mutate(
    level_lm = ordered(level_lm, labels = c(&#39;0&#39;, &#39;1&#39;))
    )

model_virsex &lt;- glm(level_lm ~ vic_sex ,family = binomial, data = dangrous_data)
summary(model_virsex)</code></pre>
<pre><code>## 
## Call:
## glm(formula = level_lm ~ vic_sex, family = binomial, data = dangrous_data)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -0.9389  -0.9389  -0.8174   1.4364   1.5867  
## 
## Coefficients:
##              Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept) -0.924672   0.002070  -446.7   &lt;2e-16 ***
## vic_sexM     0.333812   0.002938   113.6   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 2688603  on 2150241  degrees of freedom
## Residual deviance: 2675668  on 2150240  degrees of freedom
## AIC: 2675672
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<p>By observing the results, the regression coefficient of the
independent variable is positive, and the significance level is less
than 0.05. It is not difficult to see that the gender difference has a
significant significance for judging the event level. That is, women are
more likely to be persecuted in VIOLATION-level events. In the event
types with higher risk levels, the probability of men and women being in
danger will tend to be equal.</p>
</div>
<div id="relationship-between-victims-age-group-and-crime-level"
class="section level3">
<h3>Relationship between victim’s age group and crime level</h3>
<pre class="r"><code>dangrous_data = dangrous_data %&gt;% 
  mutate(
   level_lm = case_when(
     level == &#39;VIOLATION&#39; ~ 0,
     level == &quot;MISDEMEANOR&quot; ~ 1,
     level == &quot;FELONY&quot; ~ 2
   )
  )

plot_bar_agegroup = dangrous_data %&gt;% 
  group_by(level,vic_age_group) %&gt;% 
  dplyr::summarize(
    n_obs = n(),
    type = level
  ) %&gt;% 
  unique() %&gt;% 
  ggplot(
    aes(x = level,y = n_obs,fill = vic_age_group)
  ) +
  geom_bar(stat = &quot;identity&quot;) +
  labs(
    title = &quot;relationship between dangerous level and victim age range&quot;,
    x = &quot;dangerous level&quot;,
    y = &quot;number of cases&quot;
  )

plot_bar_agegroup</code></pre>
<p><img src="Analysis_Victim_files/figure-html/unnamed-chunk-5-1.png" width="80%" /></p>
<pre class="r"><code>plot_pie_age0 = dangrous_data %&gt;%
  group_by(level,vic_age_group) %&gt;% 
  dplyr::summarize(
    n_obs = n(),
    type = level_lm
  ) %&gt;% 
  unique() %&gt;%
  filter(type == 0)

plot_pie_age0 = plot_ly(data = plot_pie_age0, x = ~vic_age_group,y = ~n_obs, type = &quot;bar&quot;, color = ~vic_age_group) %&gt;% 
  layout(title = &quot;VIOLATION for vic_age&quot;)

plot_pie_age1 = dangrous_data %&gt;%
  group_by(level,vic_age_group) %&gt;% 
  dplyr::summarize(
    n_obs = n(),
    type = level_lm
  ) %&gt;% 
  unique() %&gt;%
  filter(type == 1)

plot_pie_age1 = plot_ly(data = plot_pie_age1, x = ~vic_age_group,y = ~n_obs, type = &quot;bar&quot;, color = ~vic_age_group) %&gt;% 
  layout(title = &quot;MISDEMEANOR for vic_age&quot;)

plot_pie_age2 = dangrous_data %&gt;%
  group_by(level,vic_age_group) %&gt;% 
  dplyr::summarize(
    n_obs = n(),
    type = level_lm
  ) %&gt;% 
  unique() %&gt;%
  filter(type == 2)

plot_pie_age2 = plot_ly(data = plot_pie_age2, x = ~vic_age_group,y = ~n_obs, type = &quot;bar&quot;, color = ~vic_age_group) %&gt;% 
  layout(title = &quot;FELONY for vic_age&quot;)

plot_pie_age0</code></pre>
<div id="htmlwidget-b3fc8d50e58ff4915f43" style="width:80%;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-b3fc8d50e58ff4915f43">{"x":{"visdat":{"419828df312a":["function () ","plotlyVisDat"]},"cur_data":"419828df312a","attrs":{"419828df312a":{"x":{},"y":{},"color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"VIOLATION for vic_age","xaxis":{"domain":[0,1],"automargin":true,"title":"vic_age_group","type":"category","categoryorder":"array","categoryarray":["<18","18-24","25-44","45-64","65+"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"n_obs"},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":["<18"],"y":[22833],"type":"bar","name":"<18","marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"textfont":{"color":"rgba(102,194,165,1)"},"error_y":{"color":"rgba(102,194,165,1)"},"error_x":{"color":"rgba(102,194,165,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["18-24"],"y":[47981],"type":"bar","name":"18-24","marker":{"color":"rgba(252,141,98,1)","line":{"color":"rgba(252,141,98,1)"}},"textfont":{"color":"rgba(252,141,98,1)"},"error_y":{"color":"rgba(252,141,98,1)"},"error_x":{"color":"rgba(252,141,98,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["25-44"],"y":[211098],"type":"bar","name":"25-44","marker":{"color":"rgba(141,160,203,1)","line":{"color":"rgba(141,160,203,1)"}},"textfont":{"color":"rgba(141,160,203,1)"},"error_y":{"color":"rgba(141,160,203,1)"},"error_x":{"color":"rgba(141,160,203,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["45-64"],"y":[132348],"type":"bar","name":"45-64","marker":{"color":"rgba(231,138,195,1)","line":{"color":"rgba(231,138,195,1)"}},"textfont":{"color":"rgba(231,138,195,1)"},"error_y":{"color":"rgba(231,138,195,1)"},"error_x":{"color":"rgba(231,138,195,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["65+"],"y":[27825],"type":"bar","name":"65+","marker":{"color":"rgba(166,216,84,1)","line":{"color":"rgba(166,216,84,1)"}},"textfont":{"color":"rgba(166,216,84,1)"},"error_y":{"color":"rgba(166,216,84,1)"},"error_x":{"color":"rgba(166,216,84,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>plot_pie_age1</code></pre>
<div id="htmlwidget-1d5df133aca99ce92593" style="width:80%;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-1d5df133aca99ce92593">{"x":{"visdat":{"41985514d15c":["function () ","plotlyVisDat"]},"cur_data":"41985514d15c","attrs":{"41985514d15c":{"x":{},"y":{},"color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"MISDEMEANOR for vic_age","xaxis":{"domain":[0,1],"automargin":true,"title":"vic_age_group","type":"category","categoryorder":"array","categoryarray":["<18","18-24","25-44","45-64","65+"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"n_obs"},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":["<18"],"y":[60163],"type":"bar","name":"<18","marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"textfont":{"color":"rgba(102,194,165,1)"},"error_y":{"color":"rgba(102,194,165,1)"},"error_x":{"color":"rgba(102,194,165,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["18-24"],"y":[138417],"type":"bar","name":"18-24","marker":{"color":"rgba(252,141,98,1)","line":{"color":"rgba(252,141,98,1)"}},"textfont":{"color":"rgba(252,141,98,1)"},"error_y":{"color":"rgba(252,141,98,1)"},"error_x":{"color":"rgba(252,141,98,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["25-44"],"y":[513187],"type":"bar","name":"25-44","marker":{"color":"rgba(141,160,203,1)","line":{"color":"rgba(141,160,203,1)"}},"textfont":{"color":"rgba(141,160,203,1)"},"error_y":{"color":"rgba(141,160,203,1)"},"error_x":{"color":"rgba(141,160,203,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["45-64"],"y":[264282],"type":"bar","name":"45-64","marker":{"color":"rgba(231,138,195,1)","line":{"color":"rgba(231,138,195,1)"}},"textfont":{"color":"rgba(231,138,195,1)"},"error_y":{"color":"rgba(231,138,195,1)"},"error_x":{"color":"rgba(231,138,195,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["65+"],"y":[48800],"type":"bar","name":"65+","marker":{"color":"rgba(166,216,84,1)","line":{"color":"rgba(166,216,84,1)"}},"textfont":{"color":"rgba(166,216,84,1)"},"error_y":{"color":"rgba(166,216,84,1)"},"error_x":{"color":"rgba(166,216,84,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>plot_pie_age2</code></pre>
<div id="htmlwidget-9dfe4e9589e8eab71c15" style="width:80%;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-9dfe4e9589e8eab71c15">{"x":{"visdat":{"419849bd1aa7":["function () ","plotlyVisDat"]},"cur_data":"419849bd1aa7","attrs":{"419849bd1aa7":{"x":{},"y":{},"color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"FELONY for vic_age","xaxis":{"domain":[0,1],"automargin":true,"title":"vic_age_group","type":"category","categoryorder":"array","categoryarray":["<18","18-24","25-44","45-64","65+"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"n_obs"},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":["<18"],"y":[31668],"type":"bar","name":"<18","marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"textfont":{"color":"rgba(102,194,165,1)"},"error_y":{"color":"rgba(102,194,165,1)"},"error_x":{"color":"rgba(102,194,165,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["18-24"],"y":[93409],"type":"bar","name":"18-24","marker":{"color":"rgba(252,141,98,1)","line":{"color":"rgba(252,141,98,1)"}},"textfont":{"color":"rgba(252,141,98,1)"},"error_y":{"color":"rgba(252,141,98,1)"},"error_x":{"color":"rgba(252,141,98,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["25-44"],"y":[333316],"type":"bar","name":"25-44","marker":{"color":"rgba(141,160,203,1)","line":{"color":"rgba(141,160,203,1)"}},"textfont":{"color":"rgba(141,160,203,1)"},"error_y":{"color":"rgba(141,160,203,1)"},"error_x":{"color":"rgba(141,160,203,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["45-64"],"y":[170719],"type":"bar","name":"45-64","marker":{"color":"rgba(231,138,195,1)","line":{"color":"rgba(231,138,195,1)"}},"textfont":{"color":"rgba(231,138,195,1)"},"error_y":{"color":"rgba(231,138,195,1)"},"error_x":{"color":"rgba(231,138,195,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["65+"],"y":[54196],"type":"bar","name":"65+","marker":{"color":"rgba(166,216,84,1)","line":{"color":"rgba(166,216,84,1)"}},"textfont":{"color":"rgba(166,216,84,1)"},"error_y":{"color":"rgba(166,216,84,1)"},"error_x":{"color":"rgba(166,216,84,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>dangrous_data = dangrous_data %&gt;% 
  mutate(
   level_lm = case_when(
     level == &#39;VIOLATION&#39; ~ 0,
     level == &quot;MISDEMEANOR&quot; ~ 0,
     level == &quot;FELONY&quot; ~ 1
   )
  ) %&gt;% 
  mutate(
    level_lm = ordered(level_lm, labels = c(&#39;0&#39;, &#39;1&#39;))
    )
model_viage &lt;- glm(level_lm ~ vic_age_group ,family = binomial, data = dangrous_data)

summary(model_viage)</code></pre>
<pre><code>## 
## Call:
## glm(formula = level_lm ~ vic_age_group, family = binomial, data = dangrous_data)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -1.0343  -0.8701  -0.8461   1.4813   1.6042  
## 
## Coefficients:
##                     Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)        -0.963486   0.006605 -145.87   &lt;2e-16 ***
## vic_age_group18-24  0.272589   0.007726   35.28   &lt;2e-16 ***
## vic_age_group25-44  0.187392   0.006929   27.05   &lt;2e-16 ***
## vic_age_group45-64  0.120501   0.007211   16.71   &lt;2e-16 ***
## vic_age_group65+    0.617169   0.008668   71.20   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 2688603  on 2150241  degrees of freedom
## Residual deviance: 2681177  on 2150237  degrees of freedom
## AIC: 2681187
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<p>The results show that although the victim group is mainly targeted at
25-44. With the level of dangerous increase, the 45-64 victim age group
dropped about 4 percentage points and the 18-24 victim age group rose
about 3 points. From the logistics regression,
<code>vic_age_group</code> is useful for predicting the level of
dangerous.</p>
</div>
<div id="victims-race-and-crime-level" class="section level3">
<h3>Victim’s race and crime level</h3>
<pre class="r"><code>dangrous_data = dangrous_data %&gt;% 
  mutate(
   level_lm = case_when(
     level == &#39;VIOLATION&#39; ~ 0,
     level == &quot;MISDEMEANOR&quot; ~ 1,
     level == &quot;FELONY&quot; ~ 2
   )
  )

dnd = dangrous_data %&gt;% 
  group_by(level,vic_race) %&gt;% 
  dplyr::summarize(
    n_obs = n(),
    type = level
  ) %&gt;% 
  unique() %&gt;% 
  ggplot(
    aes(x = level,y = n_obs,fill = vic_race)
  ) +
  geom_bar(stat = &quot;identity&quot;)+
  labs(
    title = &quot;relationship between dangerous and victim race&quot;,
    x = &quot;dangerous level&quot;,
    y = &quot;number of cases&quot;
  )

plot_his_race = dangrous_data %&gt;% 
  group_by(level,vic_race) %&gt;% 
  dplyr::summarize(
    n_obs = n(),
    type = level_lm
  ) %&gt;% 
  unique() %&gt;% 
  ggplot(
    aes(x = level,y = n_obs,fill=vic_race)
  ) +
  geom_bar(stat = &quot;identity&quot;)
plot_his_race</code></pre>
<p><img src="Analysis_Victim_files/figure-html/unnamed-chunk-6-1.png" width="80%" /></p>
<pre class="r"><code>plot_pie_race0=dangrous_data %&gt;%
  group_by(level,vic_race) %&gt;% 
  dplyr::summarize(
    n_obs = n(),
    type = level_lm
  ) %&gt;% 
  unique() %&gt;%
  filter(type == 0)

plot_pie_race0 = plot_ly(data = plot_pie_race0, x = ~ vic_race, y= ~n_obs, type = &quot;bar&quot;, color = ~vic_race) %&gt;% 
  layout(title = &quot;VIOLATION for vic_race&quot;)

plot_pie_race1 = dangrous_data %&gt;%
  group_by(level,vic_race) %&gt;% 
  dplyr::summarize(
    n_obs = n(),
    type = level_lm
  ) %&gt;% 
  unique() %&gt;%
  filter(type == 1)

plot_pie_race1 = plot_ly(data = plot_pie_race1, x = ~ vic_race, y= ~n_obs, type = &quot;bar&quot;, color = ~vic_race) %&gt;% 
  layout(title = &quot;MISDEMEANOR for vic_race&quot;)

plot_pie_race2 = dangrous_data %&gt;%
  group_by(level,vic_race) %&gt;% 
  dplyr::summarize(
    n_obs = n(),
    type = level_lm
  ) %&gt;% 
  unique() %&gt;%
  filter(type == 2)

plot_pie_race2 = plot_ly(data = plot_pie_race2, x = ~ vic_race, y= ~n_obs, type = &quot;bar&quot;, color = ~vic_race) %&gt;% 
  layout(title = &quot;FELONY for vic_age&quot;)

plot_pie_race0</code></pre>
<div id="htmlwidget-12cc79c4247a5d7d2cde" style="width:80%;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-12cc79c4247a5d7d2cde">{"x":{"visdat":{"419845cfaa9":["function () ","plotlyVisDat"]},"cur_data":"419845cfaa9","attrs":{"419845cfaa9":{"x":{},"y":{},"color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"VIOLATION for vic_race","xaxis":{"domain":[0,1],"automargin":true,"title":"vic_race","type":"category","categoryorder":"array","categoryarray":["AMERICAN INDIAN/ALASKAN NATIVE","ASIAN / PACIFIC ISLANDER","BLACK","BLACK HISPANIC","WHITE","WHITE HISPANIC"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"n_obs"},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":["AMERICAN INDIAN/ALASKAN NATIVE"],"y":[3058],"type":"bar","name":"AMERICAN INDIAN/ALASKAN NATIVE","marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"textfont":{"color":"rgba(102,194,165,1)"},"error_y":{"color":"rgba(102,194,165,1)"},"error_x":{"color":"rgba(102,194,165,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["ASIAN / PACIFIC ISLANDER"],"y":[38004],"type":"bar","name":"ASIAN / PACIFIC ISLANDER","marker":{"color":"rgba(252,141,98,1)","line":{"color":"rgba(252,141,98,1)"}},"textfont":{"color":"rgba(252,141,98,1)"},"error_y":{"color":"rgba(252,141,98,1)"},"error_x":{"color":"rgba(252,141,98,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["BLACK"],"y":[177269],"type":"bar","name":"BLACK","marker":{"color":"rgba(141,160,203,1)","line":{"color":"rgba(141,160,203,1)"}},"textfont":{"color":"rgba(141,160,203,1)"},"error_y":{"color":"rgba(141,160,203,1)"},"error_x":{"color":"rgba(141,160,203,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["BLACK HISPANIC"],"y":[24306],"type":"bar","name":"BLACK HISPANIC","marker":{"color":"rgba(231,138,195,1)","line":{"color":"rgba(231,138,195,1)"}},"textfont":{"color":"rgba(231,138,195,1)"},"error_y":{"color":"rgba(231,138,195,1)"},"error_x":{"color":"rgba(231,138,195,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["WHITE"],"y":[90599],"type":"bar","name":"WHITE","marker":{"color":"rgba(166,216,84,1)","line":{"color":"rgba(166,216,84,1)"}},"textfont":{"color":"rgba(166,216,84,1)"},"error_y":{"color":"rgba(166,216,84,1)"},"error_x":{"color":"rgba(166,216,84,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["WHITE HISPANIC"],"y":[108849],"type":"bar","name":"WHITE HISPANIC","marker":{"color":"rgba(255,217,47,1)","line":{"color":"rgba(255,217,47,1)"}},"textfont":{"color":"rgba(255,217,47,1)"},"error_y":{"color":"rgba(255,217,47,1)"},"error_x":{"color":"rgba(255,217,47,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>plot_pie_race1</code></pre>
<div id="htmlwidget-48498d3479583ea7647c" style="width:80%;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-48498d3479583ea7647c">{"x":{"visdat":{"4198744c6f7b":["function () ","plotlyVisDat"]},"cur_data":"4198744c6f7b","attrs":{"4198744c6f7b":{"x":{},"y":{},"color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"MISDEMEANOR for vic_race","xaxis":{"domain":[0,1],"automargin":true,"title":"vic_race","type":"category","categoryorder":"array","categoryarray":["AMERICAN INDIAN/ALASKAN NATIVE","ASIAN / PACIFIC ISLANDER","BLACK","BLACK HISPANIC","WHITE","WHITE HISPANIC"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"n_obs"},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":["AMERICAN INDIAN/ALASKAN NATIVE"],"y":[6920],"type":"bar","name":"AMERICAN INDIAN/ALASKAN NATIVE","marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"textfont":{"color":"rgba(102,194,165,1)"},"error_y":{"color":"rgba(102,194,165,1)"},"error_x":{"color":"rgba(102,194,165,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["ASIAN / PACIFIC ISLANDER"],"y":[104088],"type":"bar","name":"ASIAN / PACIFIC ISLANDER","marker":{"color":"rgba(252,141,98,1)","line":{"color":"rgba(252,141,98,1)"}},"textfont":{"color":"rgba(252,141,98,1)"},"error_y":{"color":"rgba(252,141,98,1)"},"error_x":{"color":"rgba(252,141,98,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["BLACK"],"y":[373581],"type":"bar","name":"BLACK","marker":{"color":"rgba(141,160,203,1)","line":{"color":"rgba(141,160,203,1)"}},"textfont":{"color":"rgba(141,160,203,1)"},"error_y":{"color":"rgba(141,160,203,1)"},"error_x":{"color":"rgba(141,160,203,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["BLACK HISPANIC"],"y":[59931],"type":"bar","name":"BLACK HISPANIC","marker":{"color":"rgba(231,138,195,1)","line":{"color":"rgba(231,138,195,1)"}},"textfont":{"color":"rgba(231,138,195,1)"},"error_y":{"color":"rgba(231,138,195,1)"},"error_x":{"color":"rgba(231,138,195,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["WHITE"],"y":[220892],"type":"bar","name":"WHITE","marker":{"color":"rgba(166,216,84,1)","line":{"color":"rgba(166,216,84,1)"}},"textfont":{"color":"rgba(166,216,84,1)"},"error_y":{"color":"rgba(166,216,84,1)"},"error_x":{"color":"rgba(166,216,84,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["WHITE HISPANIC"],"y":[259437],"type":"bar","name":"WHITE HISPANIC","marker":{"color":"rgba(255,217,47,1)","line":{"color":"rgba(255,217,47,1)"}},"textfont":{"color":"rgba(255,217,47,1)"},"error_y":{"color":"rgba(255,217,47,1)"},"error_x":{"color":"rgba(255,217,47,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>plot_pie_race2</code></pre>
<div id="htmlwidget-1643c77e023602f18c84" style="width:80%;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-1643c77e023602f18c84">{"x":{"visdat":{"4198462b2fe3":["function () ","plotlyVisDat"]},"cur_data":"4198462b2fe3","attrs":{"4198462b2fe3":{"x":{},"y":{},"color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"FELONY for vic_age","xaxis":{"domain":[0,1],"automargin":true,"title":"vic_race","type":"category","categoryorder":"array","categoryarray":["AMERICAN INDIAN/ALASKAN NATIVE","ASIAN / PACIFIC ISLANDER","BLACK","BLACK HISPANIC","WHITE","WHITE HISPANIC"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"n_obs"},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":["AMERICAN INDIAN/ALASKAN NATIVE"],"y":[4040],"type":"bar","name":"AMERICAN INDIAN/ALASKAN NATIVE","marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"textfont":{"color":"rgba(102,194,165,1)"},"error_y":{"color":"rgba(102,194,165,1)"},"error_x":{"color":"rgba(102,194,165,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["ASIAN / PACIFIC ISLANDER"],"y":[84157],"type":"bar","name":"ASIAN / PACIFIC ISLANDER","marker":{"color":"rgba(252,141,98,1)","line":{"color":"rgba(252,141,98,1)"}},"textfont":{"color":"rgba(252,141,98,1)"},"error_y":{"color":"rgba(252,141,98,1)"},"error_x":{"color":"rgba(252,141,98,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["BLACK"],"y":[224360],"type":"bar","name":"BLACK","marker":{"color":"rgba(141,160,203,1)","line":{"color":"rgba(141,160,203,1)"}},"textfont":{"color":"rgba(141,160,203,1)"},"error_y":{"color":"rgba(141,160,203,1)"},"error_x":{"color":"rgba(141,160,203,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["BLACK HISPANIC"],"y":[38198],"type":"bar","name":"BLACK HISPANIC","marker":{"color":"rgba(231,138,195,1)","line":{"color":"rgba(231,138,195,1)"}},"textfont":{"color":"rgba(231,138,195,1)"},"error_y":{"color":"rgba(231,138,195,1)"},"error_x":{"color":"rgba(231,138,195,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["WHITE"],"y":[168092],"type":"bar","name":"WHITE","marker":{"color":"rgba(166,216,84,1)","line":{"color":"rgba(166,216,84,1)"}},"textfont":{"color":"rgba(166,216,84,1)"},"error_y":{"color":"rgba(166,216,84,1)"},"error_x":{"color":"rgba(166,216,84,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["WHITE HISPANIC"],"y":[164461],"type":"bar","name":"WHITE HISPANIC","marker":{"color":"rgba(255,217,47,1)","line":{"color":"rgba(255,217,47,1)"}},"textfont":{"color":"rgba(255,217,47,1)"},"error_y":{"color":"rgba(255,217,47,1)"},"error_x":{"color":"rgba(255,217,47,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>dangrous_data_3 = dangrous_data %&gt;% 
  mutate(
   level_lm = case_when(
     level == &#39;VIOLATION&#39; ~ 0,
     level == &quot;MISDEMEANOR&quot; ~ 0,
     level == &quot;FELONY&quot; ~ 1
   )
  )  %&gt;% 
  mutate(
    level_lm = ordered(level_lm, labels = c(&#39;0&#39;, &#39;1&#39;))
    )
model_vicrace &lt;- glm(level_lm ~ vic_race, family = binomial, data = dangrous_data_3)

summary(model_vicrace)</code></pre>
<pre><code>## 
## Call:
## glm(formula = level_lm ~ vic_race, family = binomial, data = dangrous_data_3)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -0.9645  -0.8648  -0.8266   1.4480   1.5774  
## 
## Coefficients:
##                                   Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)                      -0.904138   0.018648 -48.485  &lt; 2e-16 ***
## vic_raceASIAN / PACIFIC ISLANDER  0.380347   0.019149  19.863  &lt; 2e-16 ***
## vic_raceBLACK                     0.005927   0.018815   0.315    0.753    
## vic_raceBLACK HISPANIC            0.113287   0.019642   5.768 8.04e-09 ***
## vic_raceWHITE                     0.287279   0.018892  15.206  &lt; 2e-16 ***
## vic_raceWHITE HISPANIC            0.097952   0.018882   5.187 2.13e-07 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 2688603  on 2150241  degrees of freedom
## Residual deviance: 2680089  on 2150236  degrees of freedom
## AIC: 2680101
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<p>The relationship between victim race and case level. The black race
occupies the majority of the victims, and as the severity of the case
increases, the proportion of black victims decreases significantly,
while the proportion of white Hispanic and ASIAN/PACIFIC ISLAND victims
gradually increases. This can be confirmed by observing the size
relationship of the logistic regression coefficient.</p>
</div>
<div id="conclude-the-multi-logistic-regression-model"
class="section level3">
<h3>Conclude the multi logistic regression model</h3>
<pre class="r"><code>dangerous = dangrous_data %&gt;%
  mutate(
   level_lm = case_when(
     level == &#39;VIOLATION&#39; ~ 0,
     level == &quot;MISDEMEANOR&quot; ~ 0,
     level == &quot;FELONY&quot; ~ 1
   ) ) %&gt;% 
  mutate(
    level_lm = ordered(level_lm, labels = c(&#39;1&#39;, &#39;0&#39;)
    ))

model_toal &lt;- glm(level_lm ~ vic_race + vic_age_group + vic_sex,family = binomial,data=dangerous)    

summary(model_toal)</code></pre>
<pre><code>## 
## Call:
## glm(formula = level_lm ~ vic_race + vic_age_group + vic_sex, 
##     family = binomial, data = dangerous)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -1.1743  -0.8920  -0.8069   1.4088   1.7489  
## 
## Coefficients:
##                                   Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)                      -1.285175   0.019951 -64.416  &lt; 2e-16 ***
## vic_raceASIAN / PACIFIC ISLANDER  0.406474   0.019215  21.154  &lt; 2e-16 ***
## vic_raceBLACK                     0.090817   0.018896   4.806 1.54e-06 ***
## vic_raceBLACK HISPANIC            0.173991   0.019718   8.824  &lt; 2e-16 ***
## vic_raceWHITE                     0.318597   0.018967  16.797  &lt; 2e-16 ***
## vic_raceWHITE HISPANIC            0.169170   0.018958   8.923  &lt; 2e-16 ***
## vic_age_group18-24                0.269861   0.007765  34.753  &lt; 2e-16 ***
## vic_age_group25-44                0.161043   0.006969  23.107  &lt; 2e-16 ***
## vic_age_group45-64                0.064622   0.007267   8.893  &lt; 2e-16 ***
## vic_age_group65+                  0.554430   0.008764  63.260  &lt; 2e-16 ***
## vic_sexM                          0.317009   0.002978 106.452  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 2688603  on 2150241  degrees of freedom
## Residual deviance: 2662120  on 2150231  degrees of freedom
## AIC: 2662142
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<pre class="r"><code>dangerous = dangerous %&gt;% 
  filter(!vic_age_group == &quot;18-24&quot;)
model_toal &lt;- glm(level_lm ~ vic_race + vic_age_group + vic_sex,family = binomial,data=dangerous)
summary(model_toal)</code></pre>
<pre><code>## 
## Call:
## glm(formula = level_lm ~ vic_race + vic_age_group + vic_sex, 
##     family = binomial, data = dangerous)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -1.1727  -0.8856  -0.7812   1.4145   1.7513  
## 
## Coefficients:
##                                   Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)                      -1.290558   0.021449 -60.167  &lt; 2e-16 ***
## vic_raceASIAN / PACIFIC ISLANDER  0.426588   0.020826  20.483  &lt; 2e-16 ***
## vic_raceBLACK                     0.098816   0.020486   4.824 1.41e-06 ***
## vic_raceBLACK HISPANIC            0.190652   0.021391   8.913  &lt; 2e-16 ***
## vic_raceWHITE                     0.331657   0.020551  16.138  &lt; 2e-16 ***
## vic_raceWHITE HISPANIC            0.192576   0.020557   9.368  &lt; 2e-16 ***
## vic_age_group25-44                0.161209   0.006969  23.131  &lt; 2e-16 ***
## vic_age_group45-64                0.066802   0.007269   9.190  &lt; 2e-16 ***
## vic_age_group65+                  0.556062   0.008770  63.405  &lt; 2e-16 ***
## vic_sexM                          0.296801   0.003194  92.919  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 2331828  on 1870434  degrees of freedom
## Residual deviance: 2309294  on 1870425  degrees of freedom
## AIC: 2309314
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<p>We finally presented the model in the form of multiple logistic
regression, but it should be noted that the information of the victim
alone cannot fit the data well, and the regression only shows the
correlation between the danger level and the characteristics of the
victim.</p>
</div>
</div>
<div id="additional-study" class="section level2">
<h2>Additional study</h2>
<p>For future research, we can deeply analyze the relationship between
the specific event content and the victim for each type of danger level.
At present, for the example of a misdemeanor, we can use a pie chart to
observe its event composition.</p>
<div id="event-composition-of-misdemeanor" class="section level3">
<h3>Event composition of misdemeanor</h3>
<pre class="r"><code>pie_chart = dangrous_data %&gt;% 
  filter(level == &quot;MISDEMEANOR&quot;)

pie_chart = pie_chart %&gt;% 
  group_by(offense) %&gt;% 
  dplyr::summarize(n = n()) %&gt;% 
  mutate(
    offense = as.character(offense)
  )

pie_chart = rbind(pie_chart,c(&quot;others&quot;,290))
pie_chart = pie_chart %&gt;% 
  mutate(
    n = as.numeric(n)
    ) %&gt;% 
  filter(n &gt; 100)

# mid victim event as offense details
plot_ly(pie_chart,labels = ~ offense,values = ~n) %&gt;% 
  add_pie %&gt;% 
  layout(title = &quot;Constituent Incidents of MISDEMEANOR&quot;)</code></pre>
<div id="htmlwidget-4a78db22283bc11c6ce7" style="width:80%;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-4a78db22283bc11c6ce7">{"x":{"visdat":{"4198f122fd5":["function () ","plotlyVisDat"]},"cur_data":"4198f122fd5","attrs":{"4198f122fd5":{"labels":{},"values":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"pie","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Constituent Incidents of MISDEMEANOR","hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"labels":["ADMINISTRATIVE CODE","ASSAULT 3 & RELATED OFFENSES","BURGLAR'S TOOLS","CRIMINAL MISCHIEF & RELATED OF","CRIMINAL TRESPASS","DANGEROUS DRUGS","DANGEROUS WEAPONS","FRAUDS","FRAUDULENT ACCOSTING","INTOXICATED & IMPAIRED DRIVING","OFF. AGNST PUB ORD SENSBLTY &","OFFENSES AGAINST PUBLIC ADMINI","OFFENSES AGAINST THE PERSON","OFFENSES INVOLVING FRAUD","OTHER OFFENSES RELATED TO THEF","OTHER STATE LAWS (NON PENAL LA","PETIT LARCENY","PETIT LARCENY OF MOTOR VEHICLE","POSSESSION OF STOLEN PROPERTY","SEX CRIMES","UNAUTHORIZED USE OF A VEHICLE","VEHICLE AND TRAFFIC LAWS","others"],"values":[5170,322026,264,135523,7823,311,1951,9992,474,2080,115367,29624,2994,280,3919,510,309693,640,1635,29551,5852,38852,290],"type":"pie","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(255,255,255,1)"}},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="difference-between-common-events" class="section level3">
<h3>Difference between common events</h3>
<pre class="r"><code>offense_data = dangrous_data %&gt;% 
  filter(offense == &quot;ASSAULT 3 &amp; RELATED OFFENSES&quot;|
           offense == &quot;OFF. AGNST PUB ORD SENSBLTY &amp;&quot;|  
           offense == &quot;CRIMINAL MISCHIEF &amp; RELATED OF&quot;|
           offense ==   &quot;PETIT LARCENY&quot;|offense==&quot;OFFENSES AGAINST PUBLIC ADMINI&quot; | 
           offense ==   &quot;SEX CRIMES&quot;) %&gt;% 
  filter(level == &quot;MISDEMEANOR&quot;)

dnd = offense_data %&gt;% 
  group_by(offense,vic_sex) %&gt;% 
  dplyr::summarize(
    n_obs = n(),
    type = level
  ) %&gt;% 
  unique() %&gt;% 
  ggplot(
    aes(x = offense,y=n_obs,fill = vic_sex)
  ) +
  geom_bar(stat = &quot;identity&quot;) +
  theme(
    axis.text.x.bottom = element_text(angle = 45, hjust = 1)
  ) +
  labs(
    title = &quot;MISDEMEANOR Incidents VS victim sex &quot;,
    x = &quot;dangerous level&quot;,
    y = &quot;number of cases&quot;
  )
dnd</code></pre>
<p><img src="Analysis_Victim_files/figure-html/unnamed-chunk-9-1.png" width="80%" /></p>
<p>By observing the important event composition of misdemeanors and the
differences in the characteristics of different victims, we can study
the relationship between victim characteristics and danger in more
detail. For example, by observing the event of OFF, AGNSTPUB ORD
SENSBLTY, we can see that it has a strong gender tendency.</p>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
